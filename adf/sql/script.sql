DECLARE @COUNTROW INT
SELECT
    @COUNTROW = COUNT(*)
FROM
    [control].[DB_DataSourceControl]
WHERE
    DB_DataSourceControlKey = $DB_DataSourceControlKey

IF @COUNTROW = 1
BEGIN
    UPDATE
    [control].[DB_DataSourceControl]
SET
    [SourceSystemName] = '$SourceSystemName',
    [SourceSystemType] = '$SourceSystemType',
    [SourceServerName] = '$SourceServerName',
    [SourceDBName] = '$SourceDBName',
    [SourceSchemaName] = '$SourceSchemaName',
    [SourceTableName] = '$SourceTableName',
    [SourceTableColumnList] = '$SourceTableColumnList',
    [SourceTableIncrementalColumnName] = '$SourceTableIncrementalColumnName',
    [RawAdlsUrlName] = '$RawAdlsUrlName',
    [RawContainerName] = '$RawContainerName',
    [RawFileExtension] = '$RawFileExtension',
    [RawFileDelineator] = '$RawFileDelineator',
    [IsActiveFlag] = '$IsActiveFlag',
    [LoadType] = '$LoadType',
    [RecordCreatedDateUTC] = '$RecordCreatedDateUTC',
    [RecordLastUpdatedDateUTC] = '$RecordLastUpdatedDateUTC',
    [RecordCreatedByName] = '$RecordCreatedByName',
    [RecordLastUpdatedByName] = '$RecordLastUpdatedByName',
    [ExecutionOrder] = '$ExecutionOrder',
    [JobScheduleID] = '$JobScheduleID',
    [SourceUserName] = '$SourceUserName',
    [SourcePwSecretName] = '$SourcePwSecretName'
WHERE
    [DB_DataSourceControlKey] = $DB_DataSourceControlKey
END
ELSE BEGIN
    SET IDENTITY_INSERT [control].[DB_DataSourceControl] ON
    INSERT INTO
    [control].[DB_DataSourceControl]
        (
        [DB_DataSourceControlKey],
        [SourceSystemName],
        [SourceSystemType],
        [SourceServerName],
        [SourceDBName],
        [SourceSchemaName],
        [SourceTableName],
        [SourceTableColumnList],
        [SourceTableIncrementalColumnName],
        [RawAdlsUrlName],
        [RawContainerName],
        [RawFileExtension],
        [RawFileDelineator],
        [IsActiveFlag],
        [LoadType],
        [RecordCreatedDateUTC],
        [RecordLastUpdatedDateUTC],
        [RecordCreatedByName],
        [RecordLastUpdatedByName],
        [ExecutionOrder],
        [JobScheduleID],
        [SourceUserName],
        [SourcePwSecretName]
        )
    VALUES
        (
            '$DB_DataSourceControlKey',
            '$SourceSystemName',
            '$SourceSystemType',
            '$SourceServerName',
            '$SourceDBName',
            '$SourceSchemaName',
            '$SourceTableName',
            '$SourceTableColumnList',
            '$SourceTableIncrementalColumnName',
            '$RawAdlsUrlName',
            '$RawContainerName',
            '$RawFileExtension',
            '$RawFileDelineator',
            '$IsActiveFlag',
            '$LoadType',
            '$RecordCreatedDateUTC',
            '$RecordLastUpdatedDateUTC',
            '$RecordCreatedByName',
            '$RecordLastUpdatedByName',
            '$ExecutionOrder',
            '$JobScheduleID',
            '$SourceUserName',
            '$SourcePwSecretName'
    )
    SET IDENTITY_INSERT [control].[DB_DataSourceControl] OFF
END
